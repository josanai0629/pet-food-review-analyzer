# ペットフードレビュー分析ツール

## 概要

ペットフードのECレビューを自動的に分析し、センチメント判定とラベリングを行うWebアプリケーションです。

## 主な機能

### 1. 自動ラベリング
レビューテキストから以下のラベルを自動検出：
- 食べる/食べない
- 吐き戻し・便の改善/吐く・便が悪くなる
- 安い/高い・値上げ
- 配送・梱包
- 賞味期限
- ジッパーが欲しい
- その他

### 2. カスタムラベル設定 🆕
**Master.xlsx拡張機能**により、お客様独自のラベルと判定ロジックを設定可能：
- **A列**：ラベル名（例：「食べない」）
- **B列**：優先度（数値、小さいほど高優先）
- **C列**：判定パターン（正規表現、|区切りで複数指定可能）

**設定例**：
```
A列：配送・梱包    B列：1    C列：配送|梱包|発送|届く|箱
A列：食べない      B列：6    C列：食べない|拒否|残す|口にしない
```

### 3. センチメント分析
- ポジティブ、ネガティブ、ニュートラルの3段階で判定
- 日本語の文脈を考慮した高度な分析アルゴリズム

### 4. 日付データの整形
- 年（yyyy形式）
- 月（mm形式）
- 年月（yyyy年mm月形式）
- クォーター（yyyyQn形式）

### 5. 統計分析
- 年月別の実数推移
- ラベル別集計
- センチメント別集計
- クォーター別まとめ

## 使い方

1. **ファイルのアップロード**
   - Raw_Review.xlsx（レビューデータ）をドラッグ&ドロップ
   - Master.xlsx（ラベルマスター）は任意でアップロード可能

2. **データ処理**
   - 「データ処理を開始」ボタンをクリック
   - 処理の進捗がリアルタイムで表示されます

3. **結果のダウンロード**
   - 処理完了後、「Excelファイルをダウンロード」ボタンをクリック
   - 3つのシートを含むExcelファイルがダウンロードされます
     - シート1：レビューデータ（分析結果付き）
     - シート2：統計分析（3つの表形式）
     - シート3：センチメント分析サマリー

## 必要なファイル形式

### Raw_Review.xlsx
以下の列が必要です：
- B列：review_date（日付）
- K列：review_text（レビューテキスト）

### Master.xlsx（オプション）

#### 従来形式（下位互換）
A列にラベル名のみ記載

#### 拡張形式（推奨） 🆕
| 列 | 項目 | 説明 | 例 |
|---|---|---|---|
| A | ラベル名 | 分類するラベル名 | 配送・梱包 |
| B | 優先度 | 判定優先順位（数値） | 1 |
| C | 判定パターン | 正規表現パターン（\|区切り） | 配送\|梱包\|発送\|届く |

**サンプルファイル**: [sample_master.csv](./sample_master.csv)をExcelで開いて参考にしてください。

## 技術仕様

- **フロントエンド**: HTML5, CSS3, JavaScript（Vanilla）
- **ライブラリ**: XLSX.js (v0.18.5)
- **ホスティング**: Vercel
- **対応ブラウザ**: Chrome, Firefox, Safari, Edge（最新版）

## プライバシーとセキュリティ

- すべての処理はブラウザ上で完結します
- サーバーへのデータ送信は行いません
- アップロードされたファイルは処理後、自動的に破棄されます

## カスタマイズのメリット

1. **業界特化**：ペットフード以外の商品レビューにも対応可能
2. **精度向上**：独自のキーワードやパターンで分類精度を向上
3. **優先度制御**：重要なラベルを優先的に判定
4. **正規表現対応**：複雑なパターンマッチングが可能

## ライセンス

MIT License

## 作者

[josanai0629](https://github.com/josanai0629)

## デモサイト

[https://pet-food-review-analyzer.vercel.app](https://pet-food-review-analyzer.vercel.app)